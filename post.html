<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1 id="postTitle">Loading...</h1>
        <nav>
            <a href="index.html">Home</a>
            <a href="login.html">Login</a>
        </nav>
        <nav>
            <a href="index.html">Home</a>
            <a href="login.html">Login</a>
        </nav>
    </header>
    
    <main>
        <article>
            <h2 id="postHeading">Post Content</h2>
            <img id="postImage" style="max-width: 100%; display: none;" alt="Post Image">
            <p id="postContent">Fetching post...</p>
        </article>

        <section>
            <h3>Comments</h3>
            <form id="commentForm">
                <label for="comment">Leave a comment:</label>
                <textarea id="comment" name="comment"></textarea>
                <button type="submit">Submit Comment</button>
            </form>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Makeup by NY</p>
    </footer>

    <script type="module">
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";
        import { db } from "./firebase.js";
    
        document.addEventListener("DOMContentLoaded", async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const postId = urlParams.get("postId");
    
            if (!postId) {
                document.body.innerHTML = "<h2>Error: No post ID found.</h2>";
                return;
            }
    
            try {
                const postRef = doc(db, "posts", postId);
                const postSnap = await getDoc(postRef);
    
                if (!postSnap.exists()) {
                    document.body.innerHTML = "<h2>Error: Post not found.</h2>";
                    return;
                }
    
                const postData = postSnap.data();
                
                document.getElementById("postTitle").innerText = postData.title;
                document.getElementById("postHeading").innerText = postData.title;
                document.getElementById("postContent").innerText = postData.content;
    
                if (postData.imageUrl) {
                    const imgElement = document.getElementById("postImage");
                    imgElement.src = postData.imageUrl;
                    imgElement.style.display = "block";
                }
            } catch (error) {
                console.error("Error fetching post:", error);
                document.body.innerHTML = "<h2>Error loading post.</h2>";
            }
        });
    </script>
</body>
</html>
